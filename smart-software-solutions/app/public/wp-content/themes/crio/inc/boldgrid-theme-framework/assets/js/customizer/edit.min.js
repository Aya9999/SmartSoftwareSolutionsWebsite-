var BOLDGRID=BOLDGRID||{};BOLDGRID.CustomizerEdit=BOLDGRID.CustomizerEdit||{};const{__:__}=wp.i18n;!function(t){"use strict";var o,e;e=parent.wp.customize,BOLDGRID.CustomizerEdit={buttonParams:window.boldgridFrameworkCustomizerEdit||{},buttonCollisionSet:{},targetHighlightTop:!0,userIsScrolling:!1,buttonHeight:0,buttonWidth:0,defaultZindex:200,init:function(){e.previewer.bind("ready",o._onLoad)},_onLoad:function(){o.destroy(),o.start(),wp.customize.selectiveRefresh.bind("partial-content-rendered",function(){o.destroy(),o.start()})},destroy:function(){o.buttonCollisionSet=[],t(".bgtfw-multi-edit-button").remove(),t(".bgtfw-edit-border-box").remove(),t(".bgtfw-edit-button").remove()},start:function(){o.$targetHighlight=t("#target-highlight"),o.addButtons(),t(window).on("scroll",function(){0>=t(window).scrollTop()?t("#masthead-sticky").css("display","none"):e("bgtfw_fixed_header")&&e("bgtfw_fixed_header")()&&t("#masthead-sticky").css("display","block")})},addButtons:function(){t(".no-edit-button").removeClass("no-edit-button"),_(o.buttonParams.params).each(function(e,i){if(t(i).each(function(){var o=t(this).clone().children().remove().end().text();(0===t(this).height()||0===t(this).outerWidth()||t(this).is("h1, h2, h3, h4, h5, h6, p, a")&&0===o.length&&!t(this).is(".site-title, .entry-title, .custom-logo-link, .site-description"))&&t(this).addClass("no-edit-button")}),1===Object.keys(e).length){let n=Object.keys(e)[0],s=o.determineButtonPosition(i),a=[".button-primary",".button-secondary",".showcoupon"].join(", "),d=[".page-title",".entry-title",".tags-links",".cat-links",".read-more",".author",".posted-on",".nav-previous",".nav-next",".logged-in-as"].join(", ");t(i).each(function(){("bgtfw_body_link_color"===n&&t(this).is(a)||"bgtfw_body_link_color"===n&&t(this).parent().is(d))&&t(this).addClass("no-"+n+"-edit-button"),("bgtfw_body_typography"===n&&t(this).is(".entry-title")||"bgtfw_body_typography"===n&&0!==t(this).siblings(".bg-hr").length)&&t(this).addClass("no-"+n+"-edit-button"),"bgtfw_headings_typography"===n&&t(this).is(".site-description, .site-title")&&t(this).addClass("no-"+n+"-edit-button")}),o.addSingleButton(i,n,e[n],s)}else{let t=o.determineButtonPosition(i);o.addMultiButtons(i,e,t)}}),o.addMenuButtons(),o.addWidgetButtons(),o.addExternalButtons(),_.defer(o.fixStaticPositioning),_.defer(o.fixCollisions),_.defer(o.fixZindex),t(":not(.bgtfw-multi-edit-button)").on("click",function(){t(".bgtfw-multi-edit-button.expanded").trigger("click")})},fixZindex:function(){var o=301;t(".sm").each(function(){o-=1,t(this).css("z-index",o)})},fixStaticPositioning:function(){t(".bgtfw-multi-edit-button, .bgtfw-edit-button").each(function(){"static"===t(this).parent().css("position")&&(t(this).parent().css("position","relative"),"bgtfw_body_link_color"===t(this).data("focus-id")&&"inline"===t(this).parent().css("display")&&t(this).parent().css("display","inline-block"))})},sortButtonsAsc:function(o,e){var i=o.offset().top,n=e.offset().top;return i===n&&(i=t(o.parent()).offset().top,n=t(e.parent()).offset().top),i<n?-1:i>n?1:0},sortButtonsDesc:function(t,o){var e=t.offset().top,i=o.offset().top;return i<e?-1:i>e?1:0},assignCollisionSet:function(t,e){var i=Math.ceil(t.offset().top)>Math.ceil(e.offset().top)?t:e,n=t.is(i)?e:t,s=n.attr("data-collision-set");i.offset({top:Math.ceil(n.offset().top)+30,left:i.offset().left}),void 0===s&&(s=o.buttonCollisionSet,o.buttonCollisionSet++),i.attr("data-collision-set",s),n.attr("data-collision-set",s)},fixCollisions:function(){var e=[];o.buttonCollisionSet=1,t(".bgtfw-multi-edit-button:visible, .bgtfw-edit-button:visible").each(function(){e.push(t(this))}),e.sort(o.sortButtonsAsc),t.each(e,function(i,n){var s=t(n);i<e.length-1&&t.each(e,function(e,i){var n=t(i);s.is(n)||o.determineButtonCollision(s,n)&&o.assignCollisionSet(s,n)})})},fixMultiCollisions:function(o){var e=t(o).height(),i=t(o).parent().offset(),n=t("#colophon.site-footer").offset().top+t("#colophon.site-footer").outerHeight(!0),s=t(window).scrollTop(),a={};i&&(0>=i.top-s-30-e&&(a.top="30px",a.bottom="unset",t(o).css(a)),e+i.top+30>=n&&(a.top="unset",a.bottom="30px",t(o).css(a)))},adjustButtonPosition:function(t,o){var e=!!t.parent(".bgtfw-has-edit").is(".left-button"),i=t.offset().top,n=Math.floor(t.offset().left),s=30*o,a=e?n+s:n-s;t.offset({top:i,left:a})},determineButtonCollision:function(t,o){var e=t.get(0).getBoundingClientRect(),i=o.get(0).getBoundingClientRect();return!(e.right<i.left||e.left>i.right||e.bottom<i.top||e.top>i.bottom)},determineButtonPosition:function(o){var e=t(o).height(),i=t(o).offset(),n=t(document).height(),s={hor:"right",vert:"bottom"};return i&&30>i.left&&(s.hor="left"),i&&e>n-(e+i.top)&&(s.vert="top"),s},addWidgetButtons:function(){var e=t("aside.sidebar");_(e).each(function(t){var e=t.id,i="sidebar-widgets-"+e,n=o.determineButtonPosition("#"+e);o.addSingleButton("#"+e,i,{type:"section",label:__("Widget Area","bgtfw")},n)})},addExternalButtons:function(){var e,i=o.determineButtonPosition(".site-content .entry-content"),n=o.determineButtonPosition("#masthead.template-header");if(o.addSingleButton(".site-content .entry-content","editPostLink",{type:"external",label:"Edit Page / Post Content",description:"Edit the Content of this Page / Post",dialogSelector:"#entry-content"},i),0!==t("#masthead.template-header").length){let i=t("#masthead.template-header").get(0).classList;const s=/template-(\d+)/;i.forEach(function(t){let i=s.exec(t);i&&(e=i[1],o.buttonParams.pageHeaderLink=o.buttonParams.editPostLink.replace(/post=\d+/,"post="+e))}),o.addMultiButtons("#masthead.template-header",{bgtfw_page_headers:{type:"section",label:__("Change Custom Page Template","bgtfw"),description:__("Choose which custom page template to display","bgtfw")},pageHeaderLink:{type:"external",label:"Edit Custom Page Header",description:"Edit the Custom Page Header",dialogSelector:"#custom-page-header"}},n)}},addMenuButtons:function(){var i=t(".bgtfw-menu-wrap");_(i).each(function(t){var i,n,s,a=t.id.split("-wrap")[0],d={};if(_(e.section("menu_locations").controls()).each(function(t){t.themeLocation===a&&(i=t.setting(),n=t.params.label)}),i){let t="ul#"+a+"-menu";d["nav_menu["+i+"]"]={type:"section",label:"Add Menu Items",description:"Add or remove items to this menu"},d["bgtfw_menu_location_"+a]={type:"panel",label:"Customize "+n,description:"Customize the styling of this menu"},s=o.determineButtonPosition(t),o.addMultiButtons(t,d,s)}else d["nav_menu_locations["+a+"]"]={type:"control",label:"Assign Menu",description:"Assign or Create a menu for this location"},d["bgtfw_menu_location_"+a]={type:"panel",label:"Customize "+n,description:"Customize the styling of this menu"},s=o.determineButtonPosition("div#"+a+"-wrap"),o.addMultiButtons("div#"+a+"-wrap",d,s)})},addMultiButtons:function(i,n,s){"static"===t(i).css("position")&&t(i).css("position","relative"),t(i).not(".no-edit-button").addClass("bgtfw-has-edit multi-edit-button"),t(i).not(".no-edit-button").addClass(s.vert+"-button "+s.hor+"-button"),t(i).not(".no-edit-button").append('<div class="bgtfw-multi-edit-button" title="Click for edit options"><div></div></div>'),t(i).not(".no-edit-button").append('<div class="bgtfw-edit-border-box"></div>'),_(n).each(function(o,e){t(i).not(".no-edit-button").find(".bgtfw-multi-edit-button").find("div").append(`\n\t\t\t\t\t<p class="bgtfw-edit-item" data-focus-type="${o.type}" data-focus-id="${e}" data-dialog-selector="${o.dialogSelector}">\n\t\t\t\t\t\t<span class="edit-label">${o.label}</span>${o.description}\n\t\t\t\t\t</p>\n\t\t\t\t`)}),t(i).find(".bgtfw-multi-edit-button").off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),t(this).toggleClass("expanded"),t(this).parent().toggleClass("expanded"),t(".bgtfw-multi-edit-button").not(this).removeClass("expanded"),t(".bgtfw-multi-edit-button, .bgtfw-edit-button").not(this).toggleClass("hidden"),t(this).parent().hasClass("expanded")&&o.fixMultiCollisions(t(this).children("div"))}),t(i).find(".bgtfw-edit-item").off("click").on("click",function(i){var n=t(this).data("focus-id"),s=t(this).data("focus-type"),a=t(this).data("dialog-selector");i.preventDefault(),i.stopPropagation(),"external"===s?o.showExternalPrompt(n,a):e[s](n).focus({completeCallback:function(){"control"===s&&e.control(n).container.fadeTo("400","0.1",function(){t(this).fadeTo("400","1")})}})})},addSingleButton:function(i,n,s,a){t(i).not(".no-"+n+"-edit-button, .no-edit-button").addClass("bgtfw-has-edit single-edit-button"),t(i).not(".no-"+n+"-edit-button, .no-edit-button").addClass(a.vert+"-button "+a.hor+"-button"),t(i).not(".no-"+n+"-edit-button, .no-edit-button").append('<div class="bgtfw-edit-button" data-focus-type="'+s.type+'" data-focus-id="'+n+'" title="'+s.label+'"><div>'),t(i).not(".no-"+n+"-edit-button, .no-edit-button").append('<div class="bgtfw-edit-border-box"></div>'),t(i).not(".no-"+n+"-edit-button, .no-edit-button").find(".bgtfw-edit-button").off("click").on("click",function(n){var a=this.dataset.focusType,d=this.dataset.focusId;"A"===t(i).not(".no-"+d+"-edit-button, .no-edit-button").prop("nodeName")&&t(i).not(".no-"+d+"-edit-button, .no-edit-button").on("click",function(t){t.preventDefault(),t.stopPropagation()}),n.preventDefault(),n.stopPropagation(),"external"===a?o.showExternalPrompt(d,s.dialogSelector):e[this.dataset.focusType](this.dataset.focusId).focus({completeCallback:function(){"control"===a&&e.control(d).container.fadeTo("700","0.1",function(){t(this).fadeTo("700","1")})}})})},showExternalPrompt:function(e,i){var n={width:400,resizable:!1,modal:!0,classes:{"ui-dialog":"bgtfw-edit-dialog"}},s=o.buttonParams.goThereNow,a=o.buttonParams[e];n.buttons={},n.buttons[s]=function(){wp.customize.preview.send("edit-post-link",a)},wp.customize.preview.bind("active",n.buttons[s]),n.buttons.cancel=function(){t(this).dialog("close")},t(i).dialog(n)}},o=BOLDGRID.CustomizerEdit}(jQuery),BOLDGRID.CustomizerEdit.init(),parent.window.BOLDGRID.CustomizerEdit=BOLDGRID.CustomizerEdit;